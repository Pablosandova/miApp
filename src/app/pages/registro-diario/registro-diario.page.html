<ion-header [translucent]="true" class="modern-header">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Registro Diario</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="modern-content">
  <!-- Estadísticas -->
  <div class="stats-container">
    <ion-card class="stats-card">
      <ion-card-content>
        <div class="stats-grid">
          <div class="stat-item racha">
            <ion-icon name="flame-outline"></ion-icon>
            <div class="stat-info">
              <span class="stat-value">{{ racha }}</span>
              <span class="stat-label">Días seguidos</span>
            </div>
          </div>
          <div class="stat-item">
            <ion-icon name="checkmark-circle-outline"></ion-icon>
            <div class="stat-info">
              <span class="stat-value">{{ registros.length }}</span>
              <span class="stat-label">Entrenamientos</span>
            </div>
          </div>
        </div>
        <div class="today-badge" *ngIf="tieneRegistroHoy()">
          <ion-icon name="checkmark-circle-outline"></ion-icon>
          ¡Ya entrenaste hoy!
        </div>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Formulario -->
  <div class="form-section">
    <div class="section-header">
      <h2>Registrar Entrenamiento</h2>
      <p>Lleva un control de tus entrenamientos completados</p>
    </div>

    <form (ngSubmit)="agregarRegistro()" class="registro-form">
      <!-- Fecha -->
      <div class="form-group">
        <ion-label class="form-label">
          <ion-icon name="calendar-outline"></ion-icon>
          Fecha
        </ion-label>
        <ion-input
          [(ngModel)]="formulario.fecha"
          name="fecha"
          type="date"
          class="modern-input"
          required>
        </ion-input>
      </div>

      <!-- Rutina -->
      <div class="form-group">
        <ion-label class="form-label">
          <ion-icon name="fitness-outline"></ion-icon>
          Rutina Realizada
        </ion-label>
        <ion-select
          [(ngModel)]="formulario.rutinaId"
          name="rutinaId"
          placeholder="Selecciona una rutina"
          interface="popover"
          class="modern-select"
          required>
          <ion-select-option *ngFor="let rutina of rutinasDisponibles" [value]="rutina.id">
            {{ rutina.nombre }} ({{ rutina.duracion }} min)
          </ion-select-option>
        </ion-select>
      </div>

      <!-- Tiempo Real -->
      <div class="form-group">
        <ion-label class="form-label">
          <ion-icon name="time-outline"></ion-icon>
          Tiempo Real (minutos)
        </ion-label>
        <ion-input
          [(ngModel)]="formulario.tiempoReal"
          name="tiempoReal"
          type="number"
          placeholder="Ej: 45"
          class="modern-input"
          required>
        </ion-input>
      </div>

      <!-- Notas -->
      <div class="form-group">
        <ion-label class="form-label">
          Notas (opcional)
        </ion-label>
        <ion-textarea
          [(ngModel)]="formulario.notas"
          name="notas"
          placeholder="¿Cómo te sentiste? ¿Alguna observación?"
          rows="3"
          class="modern-textarea">
        </ion-textarea>
      </div>

      <!-- Botón Guardar -->
      <ion-button
        type="submit"
        expand="block"
        size="large"
        class="submit-btn"
        [disabled]="!formulario.fecha || !formulario.rutinaId || !formulario.tiempoReal">
        <ion-icon name="checkmark-circle-outline" slot="start"></ion-icon>
        Registrar Entrenamiento
      </ion-button>
    </form>
  </div>

  <!-- Historial -->
  <div class="historial-section" *ngIf="registros.length > 0">
    <div class="section-header">
      <h2>Historial</h2>
      <p>Tus últimos entrenamientos</p>
    </div>

    <ion-card *ngFor="let registro of registros" class="registro-card">
      <ion-card-header>
        <div class="card-header-content">
          <div>
            <ion-card-title>{{ registro.rutinaNombre }}</ion-card-title>
            <p class="fecha">{{ formatearFecha(registro.fecha) }}</p>
          </div>
          <ion-button fill="clear" color="danger" (click)="eliminarRegistro(registro.id)">
            <ion-icon name="trash-outline" slot="icon-only"></ion-icon>
          </ion-button>
        </div>
      </ion-card-header>
      <ion-card-content>
        <div class="registro-info">
          <div class="info-item">
            <ion-icon name="time-outline"></ion-icon>
            <span>{{ registro.tiempoReal }} min</span>
          </div>
          <ion-badge color="success">
            <ion-icon name="checkmark-circle-outline"></ion-icon>
            Completado
          </ion-badge>
        </div>
        <p class="notas" *ngIf="registro.notas">{{ registro.notas }}</p>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Estado vacío -->
  <div class="empty-state" *ngIf="registros.length === 0">
    <ion-icon name="fitness-outline" class="empty-icon"></ion-icon>
    <h3>Sin registros aún</h3>
    <p>Registra tu primer entrenamiento completado</p>
  </div>
</ion-content>
